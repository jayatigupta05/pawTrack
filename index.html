<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pet Care and Tracking System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
    <h1>PawTrack</h1>

    <h2>Add a Pet</h2>
    <form action="/add-pet" method="POST">
        <label for="name">Pet Name:</label>
        <input type="text" id="name" name="name" required>

        <label for="breed">Breed:</label>
        <input type="text" id="breed" name="breed">

        <label for="age">Age:</label>
        <input type="number" id="age" name="age">

        <label for="gender">Gender:</label>
        <input type="text" id="gender" name="gender">

        <label for="vaccination_status">Vaccination Status:</label>
        <input type="text" id="vaccination_status" name="vaccination_status">

        <button type="submit">Add Pet</button>
    </form>

    <h2>View All Pets</h2>
    <button id="viewPetsBtn">View Pets</button>

    <div id="petsModal" class="modal">
        <div class="modal-content">

            <span class="close">&times;</span>
            <h2>List of Pets</h2>
            <ul id="petsList">
            </ul>
        </div>
    </div>
    <h2>Search Pet</h2>
    <form id="searchForm">
        <label for="searchName">Pet Name:</label>
        <input type="text" id="searchName" name="searchName" required>
        <button type="submit">Search</button>
    </form>

    <ul id="searchResults"></ul>


</body>
<script>
    document.getElementById("viewPetsBtn").onclick = function () {
        fetch("/api/pets")
            .then(response => response.json())
            .then(data => {
                const petsList = document.getElementById("petsList");
                petsList.innerHTML = "";
                data.forEach(pet => {
                    const li = document.createElement("li");
                    li.textContent = `${pet.name} - ${pet.breed} - ${pet.age} years old - ${pet.gender} - Vaccination: ${pet.vaccination_status}`;
                    petsList.appendChild(li);
                });

                // Show the modal
                document.getElementById("petsModal").style.display = "block";
            });
    };

    document.querySelector(".close").onclick = function () {
        document.getElementById("petsModal").style.display = "none";
    };

    window.onclick = function (event) {
        if (event.target === document.getElementById("petsModal")) {
            document.getElementById("petsModal").style.display = "none";
        }
    };
</script>
<script>
    document.getElementById("searchForm").onsubmit = function (e) {
        e.preventDefault();
        const name = document.getElementById("searchName").value;

        fetch(`/api/search?name=${encodeURIComponent(name)}`)
            .then(res => res.json())
            .then(data => {
                const results = document.getElementById("searchResults");
                results.innerHTML = "";
                if (data.length === 0) {
                    results.innerHTML = "<li>No pets found.</li>";
                } else {
                    data.forEach(pet => {
                        const li = document.createElement("li");
                        li.innerHTML = `
    <strong>Name:</strong> ${pet.name}<br>
    <strong>Breed:</strong> ${pet.breed}<br>
    <strong>Age:</strong> ${pet.age} years<br>
    <strong>Gender:</strong> ${pet.gender}<br>
    <strong>Vaccination:</strong> ${pet.vaccination_status}
`;

                        results.appendChild(li);
                    });
                }
            });
    };
</script>

</html>